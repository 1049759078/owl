#!/bin/bash
whitelist=(
80
443
1222
1223
1229
2181
2182
3181
3306
3307
3308
3309
4242
4248
6080
6360
6361
6370
6371
6372
6373
6374
6375
6376
6377
6378
6379
6380
6381
6382
6383
6384
6385
6389
8000
8004
8009
8019
8020
8040
8042
8070
8078
8079
8080
8081
8082
8083
8084
8085
8086
8087
8088
8089
8090
8091
8092
8093
8094
8095
8096
8097
8098
8099
8100
8101
8102
8103
8104
8105
8135
8443
8444
8447
8480
8485
8552
8773
8774
8775
8776
8777
8787
8888
8899
8998
8999
9000
9001
9002
9003
9004
9005
9006
9007
9008
9010
9078
9079
9080
9081
9082
9083
9086
9087
9088
9089
9090
9091
9092
9093
9094
9095
9096
9097
9098
9099
9189
9191
9200
9201
9202
9206
9292
9300
9301
9302
9443
9444
9445
9446
9447
9696
9887
9888
9898
9981
9982
9998
50010
50020
50030
50060
50070
60010
60020
60030
)
res=""
for arg in mysqld java python redis-server httpd nginx
do
	data=$(netstat -nltp | grep -v "127.0.0.1" | grep $arg | awk -F '[ :/]+' '{if($5 != "*")printf("%s,",$5);else printf("%s,",$4)}'|sed 's/,/ /g')
	ports=""
	for port in $data
	do
		for wport in ${whitelist[@]}
		do
			if [ "$port" -eq "$wport" ];then
				ports+=$port,
				break
			fi

		done
	done
	ports=$(echo $ports | sed 's/,$//')
	res+="\"$arg\":[$ports],"
done
res=$(echo $res | sed 's/,$//')
echo "{$res}" 
